# StringLightCAD 0.1 3D 建模工具

**StringLightCAD** 是一个基于 Web 的轻量级 3D CAD 建模应用程序。它使用 React、Three.js (@react-three/fiber) 和 TypeScript 构建，提供了类似桌面 CAD 软件的交互体验。

本项目支持基础几何体创建、参数化编辑、布尔运算（合并/切割）、STL 模型导入导出以及基于工作平面的装配功能。

---

## 🚀 快速开始

### 1. 环境准备
确保您的电脑上已安装 **Node.js** (推荐 v16 或更高版本)。
可以在终端输入 `node -v` 检查。

### 2. 安装依赖
在项目根目录下打开终端，运行以下命令安装项目所需的依赖库：

```bash
npm install
```

如果您是手动搭建的项目，请确保安装了以下核心库：
```bash
npm install three @types/three @react-three/fiber @react-three/drei uuid @types/uuid three-bvh-csg
```

### 3. 配置本地模型库 (可选)
为了使用**模型库**的自动扫描功能：
1. 在 `src` 目录下创建一个名为 `models` 的文件夹：`src/models`。
2. 将您的 `.stl` 文件放入该文件夹中。
3. 软件启动时会自动识别并生成预览。

### 4. 启动项目
运行开发服务器：

```bash
npm run dev
```
打开浏览器访问控制台显示的地址（通常是 `http://localhost:5173`）。

---

## 📖 使用指南

### 1. 视图操作 (鼠标控制)
*   **旋转视角**：按住 **鼠标左键** 拖动。
*   **平移视角**：按住 **鼠标右键** 拖动。
*   **缩放视角**：滚动 **鼠标滚轮**。
*   **选中物体**：点击场景中的物体（选中后显示黄色轮廓）。
*   **多选**：按住 `Ctrl` 或 `Command` 键点击物体。
*   **取消选择**：点击背景空白处。

### 2. 工具栏功能
工具栏位于屏幕顶部，分为两行：

**第一行 (系统与变换)**
*   **撤回 (Undo)**：撤销上一步操作。
*   **变换模式**：
    *   `移动`：显示三轴箭头，拖动可改变位置。
    *   `旋转`：显示旋转圆环，拖动可改变角度。
    *   `缩放`：显示缩放方块，拖动可改变大小。
*   **工作平面**：用于物体对齐和装配（详见下方）。
*   **库 (Library)**：打开模型库浏览和导入 STL 模型。
*   **导入/导出**：加载本地 STL 文件或将当前场景导出为 STL。

**第二行 (建模与编辑)**
*   **创建形状**：点击图标快速添加 方块、球体、圆柱、圆锥、三棱柱、半球体、半圆柱、圆环。
*   **布尔运算**：
    *   `合并 (Union)`：将两个物体融合成一个。
    *   `切割 (Subtract)`：用后选的物体去减去先选的物体。
*   **删除**：删除当前选中的物体。

### 3. 核心功能详解

#### 📐 参数化编辑 (右侧面板)
选中一个物体后，右侧属性面板会显示其详细信息：
*   **基础属性**：修改名称、颜色、位置、旋转、缩放。
*   **几何参数**：对于内置形状（如方块），可以修改长宽高、半径等参数，模型会实时更新。
*   **等比例缩放**：勾选“等比例缩放”后，修改一个轴的缩放值，其他轴会自动同步。

#### 🔗 布尔运算流程
1.  **选中主物体**（例如：要被挖洞的墙）。
2.  点击工具栏的 **切割** 或 **合并** 按钮。
3.  界面会出现提示：“请选择第二个物体”。
4.  **点击第二个物体**（例如：用来挖洞的圆柱）。
5.  运算自动执行，生成新的复合物体。

#### 🛠️ 工作平面 (Work Plane) - 对齐与装配
此功能用于将一个物体精确贴合到另一个物体的表面。
1.  点击 **工作平面** 按钮。
2.  **步骤 1**：点击场景中任意物体的平面，作为“基准面”（会出现蓝色网格）。
3.  **步骤 2**：
    *   点击另一个物体：该物体会自动移动并旋转，使其表面与基准面贴合。
    *   或者直接**创建新物体**：新物体会直接生成在基准面上。
4.  **操作**：
    *   在工作平面模式下，物体只能沿平面移动（锁定 Z 轴）。
    *   点击 **翻转 (Flip)** 按钮可改变对齐方向（如正反面切换）。
5.  点击 **退出模式** 完成操作。

#### 📂 模型库
*   **自动加载**：将 STL 文件放入 `src/models` 文件夹，打开库即可看到。
*   **手动加载**：在库弹窗中点击“打开模型文件夹”，选择电脑上的任意文件夹，即可预览其中的所有 STL 文件。
*   **实时预览**：点击列表中的模型，右侧会显示可交互的 3D 预览图。

---

## 💻 快捷键
*   **Delete / Backspace**: 删除选中物体。
*   **Ctrl + Click**: 多选。
*   **Enter**: 在属性面板输入数值后确认修改。

---

## 📦 构建发布
要将项目构建为静态文件（用于部署到服务器）：

```bash
npm run build
```
构建产物将生成在 `dist` 目录下。

---

## ⚠️ 常见问题
1.  **布尔运算失败/破面**：请确保参与运算的 STL 模型是封闭的实体（Watertight）。软件会自动尝试修复顶点，但对于质量极差的模型可能会失败。
2.  **模型库为空**：请检查 `src/models` 文件夹是否存在，或使用“打开模型文件夹”功能手动指定路径。
3.  **无法选中物体**：如果在工作平面模式下，请尝试退出模式或旋转视角避开蓝色的辅助网格。